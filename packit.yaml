# See the documentation for more information:
# https://packit.dev/docs/configuration/

specfile_path: rust-ticky.spec

# add or remove files that should be synced
files_to_sync:
    - rust-ticky.spec
    - packit.yaml
    - Cargo.toml
    - rust-toolchain
    - rustfmt.toml
    - COPYING
    - LICENSE.md
    - NOTICE
    - src: .cargo/
      dest: .cargo/
    - src: src/
      dest: src/

# name in upstream package repository/registry (e.g. in PyPI)
upstream_package_name: ticky
upstream_project_url: https://github.com/Dirout/ticky
copy_upstream_release_description: true
issue_repository: https://github.com/Dirout/ticky
# downstream (Fedora) RPM package name
downstream_package_name: rust-ticky

release_suffix: "{PACKIT_RPMSPEC_RELEASE}.{PACKIT_PROJECT_BRANCH}.{PACKIT_PROJECT_COMMIT}"

srpm_build_deps:
  - gcc
  - rust
  - cargo
  - rust-packaging

jobs:
- job: copr_build
  trigger: commit
  branch: master
  targets: [fedora-stable]

- job: tests
  trigger: pull_request
  targets: [fedora-stable]

- job: propose_downstream
  trigger: release
  dist_git_branches:
    - fedora-all

actions:
  get-current-version: bash -c  "cargo pkgid | cut -d# -f2 | cut -d: -f2"